<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STSAFE-A120_Accessory_authentication: STSE AES cryptography</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">STSAFE-A120_Accessory_authentication
   &#160;<span id="projectnumber">v1.0.0</span>
   </div>
   <div id="projectbrief">Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dd/de6/a00548.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">STSE AES cryptography<div class="ingroups"><a class="el" href="../../dc/dac/a00585.html">STSecureElement Library</a> &raquo; <a class="el" href="../../de/dde/a00587.html">API layer</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for STSE AES cryptography:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dd/de6/a00548.png" border="0" usemap="#add_2de6_2a00548" alt=""/></div>
<map name="add_2de6_2a00548" id="add_2de6_2a00548">
<area shape="rect" href="../../de/dde/a00587.html" title="STSELib API Layer." alt="" coords="5,5,85,31"/>
<area shape="rect" title="STSE data storage API set." alt="" coords="133,5,307,31"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga667334655eca69909683ab6884a95824"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de6/a00548.html#ga667334655eca69909683ab6884a95824">stse_aes_ecb_encrypt</a> (<a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *pSTSE, PLAT_UI8 slot_number, PLAT_UI16 message_length, PLAT_UI8 *pPlaintext_message, PLAT_UI8 *pEncrypted_message)</td></tr>
<tr class="separator:ga667334655eca69909683ab6884a95824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga858bd21e92c3afe1bcc7753cafa1e7f0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de6/a00548.html#ga858bd21e92c3afe1bcc7753cafa1e7f0">stse_aes_ecb_decrypt</a> (<a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *pSTSE, PLAT_UI8 slot_number, PLAT_UI16 message_length, PLAT_UI8 *pEncrypted_message, PLAT_UI8 *pPlaintext_message)</td></tr>
<tr class="separator:ga858bd21e92c3afe1bcc7753cafa1e7f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9c8bfb2bbe76631e80c696a2ccc48331"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de6/a00548.html#ga9c8bfb2bbe76631e80c696a2ccc48331">stse_aes_ccm_encrypt</a> (<a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *pSTSE, PLAT_UI8 slot_number, PLAT_UI8 authentication_tag_length, PLAT_UI8 *pNonce, PLAT_UI16 associated_data_length, PLAT_UI8 *pAssociated_data, PLAT_UI16 message_length, PLAT_UI8 *pPlaintext_message, PLAT_UI8 *pEncrypted_message, PLAT_UI8 *pAuthentication_tag, PLAT_UI8 *pCounter_presence, PLAT_UI32 *pCounter)</td></tr>
<tr class="separator:ga9c8bfb2bbe76631e80c696a2ccc48331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga362ca17417edb45f9bb195901240cb71"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de6/a00548.html#ga362ca17417edb45f9bb195901240cb71">stse_aes_ccm_decrypt</a> (<a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *pSTSE, PLAT_UI8 slot_number, PLAT_UI8 authentication_tag_length, PLAT_UI8 *pNonce, PLAT_UI16 associated_data_length, PLAT_UI8 *pAssociated_data, PLAT_UI16 message_length, PLAT_UI8 *pEncrypted_message, PLAT_UI8 *pAuthentication_tag, PLAT_UI8 *pVerification_result, PLAT_UI8 *pPlaintext_message)</td></tr>
<tr class="separator:ga362ca17417edb45f9bb195901240cb71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafd9c3bad4b1c88f8b970802890dc4084"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de6/a00548.html#gafd9c3bad4b1c88f8b970802890dc4084">stse_aes_gcm_encrypt</a> (<a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *pSTSE, PLAT_UI8 slot_number, PLAT_UI8 authentication_tag_length, PLAT_UI16 IV_length, PLAT_UI8 *pIV, PLAT_UI16 associated_data_length, PLAT_UI8 *pAssociated_data, PLAT_UI16 message_length, PLAT_UI8 *pPlaintext_message, PLAT_UI8 *pEncrypted_message, PLAT_UI8 *pAuthentication_tag)</td></tr>
<tr class="separator:gafd9c3bad4b1c88f8b970802890dc4084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac5f657a57f8b9cb48e1bfd145e52068b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de6/a00548.html#gac5f657a57f8b9cb48e1bfd145e52068b">stse_aes_gcm_decrypt</a> (<a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *pSTSE, PLAT_UI8 slot_number, PLAT_UI8 authentication_tag_length, PLAT_UI16 IV_length, PLAT_UI8 *pIV, PLAT_UI16 associated_data_length, PLAT_UI8 *pAssociated_data, PLAT_UI16 message_length, PLAT_UI8 *pEncrypted_message, PLAT_UI8 *pAuthentication_tag, PLAT_UI8 *pVerification_result, PLAT_UI8 *pPlaintext_message)</td></tr>
<tr class="separator:gac5f657a57f8b9cb48e1bfd145e52068b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The data storage API set provides high level functions to manage Access to the Secure User NVM of STSAFE devices. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga667334655eca69909683ab6884a95824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga667334655eca69909683ab6884a95824">&#9670;&nbsp;</a></span>stse_aes_ecb_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> stse_aes_ecb_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *&#160;</td>
          <td class="paramname"><em>pSTSE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8&#160;</td>
          <td class="paramname"><em>slot_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>message_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pPlaintext_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pEncrypted_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt payload in AES ECB mode. </p>
<p>This API encrypt payload in AES ECB mode using the specified key from STSAFE symmetric key table </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pSTSE</td><td>Pointer to STSAFE Handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slot_number</td><td>Key slot in symmetric key table to be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message_length</td><td>Length of the message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pPlaintext_message</td><td>Plaintext message to encrypt </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pEncrypted_message</td><td>Encrypted message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> : STSAFE_OK on success ; error code otherwise</dd></dl>
<p><b>Description</b> Following diagram illustrates the interactions performed between the Host and the target STSE device during the API execution <br  />
<br  />
 </p><div class="plantumlgraph">
<img src="../../inline_umlgraph_1.png" />
</div>
<br  />
<br  />
 <b>Use-case</b> <b>example</b> <br  />
 The following applicative code snippet illustrates how to use this API function in main application. <br  />
<br  />
 </p><div class="fragment"><div class="line"><a class="code" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f" title="STSE response codes enumeration.">stse_ReturnCode_t</a> ret;</div>
<div class="line">PLAT_UI8 slot_number = 0;</div>
<div class="line">PLAT_UI8 message[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,</div>
<div class="line">                      0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F};</div>
<div class="line">PLAT_UI8 output[<span class="keyword">sizeof</span>(message)];</div>
<div class="line"> </div>
<div class="line">ret = <a class="code" href="../../dd/de6/a00548.html#ga667334655eca69909683ab6884a95824" title="Encrypt payload in AES ECB mode.">stse_aes_ecb_encrypt</a>(pStse_handler,</div>
<div class="line">    slot_number,</div>
<div class="line">    <span class="keyword">sizeof</span>(message),</div>
<div class="line">    message,</div>
<div class="line">    output);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(ret != <a class="code" href="../../d0/d3e/a00566.html#gga6e312aa8b8cd38421ce8b85215e4b16fa0d3996f0849d6b075a5b9a12c147870c">STSE_OK</a> )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Handle Error */</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../dd/de9/a00552.html#ga68ba486aaac219e6120a619c2e2b749e" title="Initialize target device.">stse_init</a></dd></dl>
<div style="page-break-after: always;"></div> </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d5d/a00311_source.html#l00020">20</a> of file <a class="el" href="../../d1/d5d/a00311_source.html">stse_aes.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d70/a00431_source.html#l00020">stsafea_aes_ecb_encrypt()</a>, and <a class="el" href="../../d3/d29/a00419_source.html#l00105">STSE_API_HANDLER_NOT_INITIALISED</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dd/de6/a00548_ga667334655eca69909683ab6884a95824_cgraph.png" border="0" usemap="#add/de6/a00548_ga667334655eca69909683ab6884a95824_cgraph" alt=""/></div>
<map name="add/de6/a00548_ga667334655eca69909683ab6884a95824_cgraph" id="add/de6/a00548_ga667334655eca69909683ab6884a95824_cgraph">
<area shape="rect" title="Encrypt payload in AES ECB mode." alt="" coords="5,5,171,32"/>
<area shape="rect" href="../../d2/dd7/a00567.html#ga877531a10a30a58a9a947bb8b30d5cf8" title="Encrypt payload in AES ECB mode." alt="" coords="219,5,405,32"/>
</map>
</div>

</div>
</div>
<a id="ga858bd21e92c3afe1bcc7753cafa1e7f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga858bd21e92c3afe1bcc7753cafa1e7f0">&#9670;&nbsp;</a></span>stse_aes_ecb_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> stse_aes_ecb_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *&#160;</td>
          <td class="paramname"><em>pSTSE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8&#160;</td>
          <td class="paramname"><em>slot_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>message_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pEncrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pPlaintext_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt payload in AES ECB mode. </p>
<p>This API decrypt payload in AES ECB mode using the specified key from STSAFE symmetric key table </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pSTSE</td><td>Pointer to STSAFE Handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slot_number</td><td>Key slot in symmetric key table to be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message_length</td><td>Length of the message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pEncrypted_message</td><td>Encrypted message to decrypt </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pPlaintext_message</td><td>Plaintext message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> : STSAFE_OK on success ; error code otherwise</dd></dl>
<p><b>Description</b> Following diagram illustrates the interactions performed between the Host and the target STSE device during the API execution <br  />
<br  />
 </p><div class="plantumlgraph">
<img src="../../inline_umlgraph_2.png" />
</div>
<br  />
<br  />
 <b>Use-case</b> <b>example</b> <br  />
 The following applicative code snippet illustrates how to use this API function in main application. <br  />
<br  />
 </p><div class="fragment"><div class="line"><a class="code" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f" title="STSE response codes enumeration.">stse_ReturnCode_t</a> ret;</div>
<div class="line">PLAT_UI8 slot_number = 0;</div>
<div class="line">PLAT_UI8 ciphertext[] = {0x27, 0x9F, 0xB7, 0x4A, 0x75, 0x72, 0x13, 0x5E,</div>
<div class="line">                         0x8F, 0x9B, 0x8E, 0xF6, 0xD1, 0xEE, 0xE0, 0x03};</div>
<div class="line">PLAT_UI8 output[<span class="keyword">sizeof</span>(ciphertext)];</div>
<div class="line"> </div>
<div class="line">ret = <a class="code" href="../../dd/de6/a00548.html#ga858bd21e92c3afe1bcc7753cafa1e7f0" title="Decrypt payload in AES ECB mode.">stse_aes_ecb_decrypt</a>(pStse_handler,</div>
<div class="line">    slot_number,</div>
<div class="line">    <span class="keyword">sizeof</span>(ciphertext),</div>
<div class="line">    ciphertext,</div>
<div class="line">    output);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(ret != <a class="code" href="../../d0/d3e/a00566.html#gga6e312aa8b8cd38421ce8b85215e4b16fa0d3996f0849d6b075a5b9a12c147870c">STSE_OK</a> )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Handle Error */</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../dd/de9/a00552.html#ga68ba486aaac219e6120a619c2e2b749e" title="Initialize target device.">stse_init</a></dd></dl>
<div style="page-break-after: always;"></div> </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d5d/a00311_source.html#l00040">40</a> of file <a class="el" href="../../d1/d5d/a00311_source.html">stse_aes.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d70/a00431_source.html#l00107">stsafea_aes_ecb_decrypt()</a>, and <a class="el" href="../../d3/d29/a00419_source.html#l00105">STSE_API_HANDLER_NOT_INITIALISED</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dd/de6/a00548_ga858bd21e92c3afe1bcc7753cafa1e7f0_cgraph.png" border="0" usemap="#add/de6/a00548_ga858bd21e92c3afe1bcc7753cafa1e7f0_cgraph" alt=""/></div>
<map name="add/de6/a00548_ga858bd21e92c3afe1bcc7753cafa1e7f0_cgraph" id="add/de6/a00548_ga858bd21e92c3afe1bcc7753cafa1e7f0_cgraph">
<area shape="rect" title="Decrypt payload in AES ECB mode." alt="" coords="5,5,171,32"/>
<area shape="rect" href="../../d2/dd7/a00567.html#gaea25d6971618311ff5ae66fccd0f74b6" title="Decrypt payload in AES ECB mode." alt="" coords="219,5,405,32"/>
</map>
</div>

</div>
</div>
<a id="ga9c8bfb2bbe76631e80c696a2ccc48331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9c8bfb2bbe76631e80c696a2ccc48331">&#9670;&nbsp;</a></span>stse_aes_ccm_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> stse_aes_ccm_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *&#160;</td>
          <td class="paramname"><em>pSTSE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8&#160;</td>
          <td class="paramname"><em>slot_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8&#160;</td>
          <td class="paramname"><em>authentication_tag_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pNonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>associated_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pAssociated_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>message_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pPlaintext_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pEncrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pAuthentication_tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pCounter_presence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI32 *&#160;</td>
          <td class="paramname"><em>pCounter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt payload in AES CCM* mode. </p>
<p>This API Encrypt payload in AES CCM* mode using the specified key from STSAFE symmetric key table </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pSTSE</td><td>Pointer to STSAFE Handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slot_number</td><td>Key slot in symmetric key table to be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">authentication_tag_length</td><td>Expected length for the authentication tag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pNonce</td><td>Buffer containing the nonce </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data_length</td><td>Length of the associated data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pAssociated_data</td><td>Buffer containing associated data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message_length</td><td>Length of the message to encrypt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pPlaintext_message</td><td>Buffer containing the message to encrypt </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pEncrypted_message</td><td>Buffer to store the encrypted message </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pAuthentication_tag</td><td>Buffer to store the authentication tag </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pCounter_presence</td><td>Counter presence flag </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pCounter</td><td>Buffer containing counter value if present </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> : STSAFE_OK on success ; error code otherwise</dd></dl>
<p><b>Description</b> Following diagram illustrates the interactions performed between the Host and the target STSE device during the API execution <br  />
<br  />
 </p><div class="plantumlgraph">
<img src="../../inline_umlgraph_3.png" />
</div>
<br  />
<br  />
 <b>Use-case</b> <b>example</b> <br  />
 The following applicative code snippet illustrates how to use this API function in main application. <br  />
<br  />
 </p><div class="fragment"><div class="line"><a class="code" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f" title="STSE response codes enumeration.">stse_ReturnCode_t</a> ret;</div>
<div class="line">PLAT_UI8 associated_data[]      = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07};</div>
<div class="line">PLAT_UI8 associated_data_length = 8;</div>
<div class="line">PLAT_UI8 plaintext[]            = {0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,</div>
<div class="line">                                   0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,</div>
<div class="line">                                   0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F};</div>
<div class="line">PLAT_UI8 plaintextLength        = 24;</div>
<div class="line">PLAT_UI8 nonce[]                = {0x00, 0x00, 0x00, 0x04, 0x03, 0x02, 0x01, 0xA0,</div>
<div class="line">                                   0xA1, 0xA2, 0xA3, 0xA4, 0xA5};</div>
<div class="line">PLAT_UI8 macLength              = 8;</div>
<div class="line">PLAT_UI8 mac[macLength];</div>
<div class="line">PLAT_UI8 ciphertext[plaintextLength];</div>
<div class="line"> </div>
<div class="line">ret = <a class="code" href="../../dd/de6/a00548.html#ga9c8bfb2bbe76631e80c696a2ccc48331" title="Encrypt payload in AES CCM* mode.">stse_aes_ccm_encrypt</a>(</div>
<div class="line">        pStse_handler,</div>
<div class="line">        slot_number,</div>
<div class="line">        macLength,</div>
<div class="line">        nonce,</div>
<div class="line">        associated_data_length,</div>
<div class="line">        associated_data,</div>
<div class="line">        plaintextLength,</div>
<div class="line">        plaintext,</div>
<div class="line">        ciphertext,</div>
<div class="line">        mac,</div>
<div class="line">        NULL,  <span class="comment">// No counter</span></div>
<div class="line">        NULL); <span class="comment">// No counter</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(ret != <a class="code" href="../../d0/d3e/a00566.html#gga6e312aa8b8cd38421ce8b85215e4b16fa0d3996f0849d6b075a5b9a12c147870c">STSE_OK</a> )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Handle Error */</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../dd/de9/a00552.html#ga68ba486aaac219e6120a619c2e2b749e" title="Initialize target device.">stse_init</a></dd></dl>
<div style="page-break-after: always;"></div> </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d5d/a00311_source.html#l00060">60</a> of file <a class="el" href="../../d1/d5d/a00311_source.html">stse_aes.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d70/a00431_source.html#l00190">stsafea_aes_ccm_encrypt()</a>, and <a class="el" href="../../d3/d29/a00419_source.html#l00105">STSE_API_HANDLER_NOT_INITIALISED</a>.</p>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dd/de6/a00548_ga9c8bfb2bbe76631e80c696a2ccc48331_cgraph.png" border="0" usemap="#add/de6/a00548_ga9c8bfb2bbe76631e80c696a2ccc48331_cgraph" alt=""/></div>
<map name="add/de6/a00548_ga9c8bfb2bbe76631e80c696a2ccc48331_cgraph" id="add/de6/a00548_ga9c8bfb2bbe76631e80c696a2ccc48331_cgraph">
<area shape="rect" title="Encrypt payload in AES CCM* mode." alt="" coords="5,5,175,32"/>
<area shape="rect" href="../../d2/dd7/a00567.html#gac08ef3bbbdc85269b28a0e0c64aa4006" title="Encrypt payload in AES CCM* mode." alt="" coords="223,5,413,32"/>
</map>
</div>

</div>
</div>
<a id="ga362ca17417edb45f9bb195901240cb71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga362ca17417edb45f9bb195901240cb71">&#9670;&nbsp;</a></span>stse_aes_ccm_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> stse_aes_ccm_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *&#160;</td>
          <td class="paramname"><em>pSTSE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8&#160;</td>
          <td class="paramname"><em>slot_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8&#160;</td>
          <td class="paramname"><em>authentication_tag_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pNonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>associated_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pAssociated_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>message_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pEncrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pAuthentication_tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pVerification_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pPlaintext_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt payload in AES CCM* mode. </p>
<p>This API Decrypt payload in AES CCM* mode using the specified key from STSAFE symmetric key table </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pSTSE</td><td>Pointer to STSAFE Handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slot_number</td><td>Key slot in symmetric key table to be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">authentication_tag_length</td><td>Expected length for the authentication tag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pNonce</td><td>Buffer containing the nonce </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data_length</td><td>Length of the associated data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pAssociated_data</td><td>Buffer containing associated data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message_length</td><td>Length of the message to encrypt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pEncrypted_message</td><td>Buffer containing the message to decrypt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pAuthentication_tag</td><td>Buffer containing the authentication tag </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pVerification_result</td><td>Verification result flag </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pPlaintext_message</td><td>Buffer to store the decrypted message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> : STSAFE_OK on success ; error code otherwise</dd></dl>
<p><b>Description</b> Following diagram illustrates the interactions performed between the Host and the target STSE device during the API execution <br  />
<br  />
 </p><div class="plantumlgraph">
<img src="../../inline_umlgraph_4.png" />
</div>
<br  />
<br  />
 <b>Use-case</b> <b>example</b> <br  />
 The following applicative code snippet illustrates how to use this API function in main application. <br  />
<br  />
 </p><div class="fragment"><div class="line"><a class="code" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f" title="STSE response codes enumeration.">stse_ReturnCode_t</a> ret;</div>
<div class="line">PLAT_UI8 associated_data[]      = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07};</div>
<div class="line">PLAT_UI8 associated_data_length = 8;</div>
<div class="line">PLAT_UI8 plaintextLength        = 24;</div>
<div class="line">PLAT_UI8 nonce[]                = {0x00, 0x00, 0x00, 0x04, 0x03, 0x02, 0x01, 0xA0,</div>
<div class="line">                                   0xA1, 0xA2, 0xA3, 0xA4, 0xA5};</div>
<div class="line">PLAT_UI8 mac[]                  = {0xA0, 0x91, 0xD5, 0x6E, 0x10, 0x40, 0x09, 0x16};</div>
<div class="line">PLAT_UI8 macLength              = 8;</div>
<div class="line">PLAT_UI8 ciphertext[]           = {0x72, 0xC9, 0x1A, 0x36, 0xE1, 0x35, 0xF8, 0xCF,</div>
<div class="line">                                   0x29, 0x1C, 0xA8, 0x94, 0x08, 0x5C, 0x87, 0xE3,</div>
<div class="line">                                   0xCC, 0x15, 0xC4, 0x39, 0xC9, 0xE4, 0x3A, 0x3B};</div>
<div class="line">PLAT_UI8 verification_result    = 0;</div>
<div class="line">PLAT_UI8 plaintext[plaintextLength];</div>
<div class="line"> </div>
<div class="line">ret = <a class="code" href="../../dd/de6/a00548.html#ga362ca17417edb45f9bb195901240cb71" title="Decrypt payload in AES CCM* mode.">stse_aes_ccm_decrypt</a>(pStse_handler,</div>
<div class="line">        slot_number,</div>
<div class="line">        macLength,</div>
<div class="line">        nonce,</div>
<div class="line">        associated_data_length,</div>
<div class="line">        associated_data,</div>
<div class="line">        plaintextLength,</div>
<div class="line">        ciphertext,</div>
<div class="line">        mac,</div>
<div class="line">        &amp;verification_result,</div>
<div class="line">        plaintext);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>(ret != <a class="code" href="../../d0/d3e/a00566.html#gga6e312aa8b8cd38421ce8b85215e4b16fa0d3996f0849d6b075a5b9a12c147870c">STSE_OK</a> )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Handle Error */</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="../../dd/de9/a00552.html#ga68ba486aaac219e6120a619c2e2b749e" title="Initialize target device.">stse_init</a></dd></dl>
<div style="page-break-after: always;"></div> </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d5d/a00311_source.html#l00094">94</a> of file <a class="el" href="../../d1/d5d/a00311_source.html">stse_aes.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d70/a00431_source.html#l00305">stsafea_aes_ccm_decrypt()</a>, and <a class="el" href="../../d3/d29/a00419_source.html#l00105">STSE_API_HANDLER_NOT_INITIALISED</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dd/de6/a00548_ga362ca17417edb45f9bb195901240cb71_cgraph.png" border="0" usemap="#add/de6/a00548_ga362ca17417edb45f9bb195901240cb71_cgraph" alt=""/></div>
<map name="add/de6/a00548_ga362ca17417edb45f9bb195901240cb71_cgraph" id="add/de6/a00548_ga362ca17417edb45f9bb195901240cb71_cgraph">
<area shape="rect" title="Decrypt payload in AES CCM* mode." alt="" coords="5,5,175,32"/>
<area shape="rect" href="../../d2/dd7/a00567.html#ga81372d20528381fab8198dfcfa6947e2" title="Decrypt payload in AES CCM* mode." alt="" coords="223,5,413,32"/>
</map>
</div>

</div>
</div>
<a id="gafd9c3bad4b1c88f8b970802890dc4084"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafd9c3bad4b1c88f8b970802890dc4084">&#9670;&nbsp;</a></span>stse_aes_gcm_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> stse_aes_gcm_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *&#160;</td>
          <td class="paramname"><em>pSTSE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8&#160;</td>
          <td class="paramname"><em>slot_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8&#160;</td>
          <td class="paramname"><em>authentication_tag_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>IV_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pIV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>associated_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pAssociated_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>message_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pPlaintext_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pEncrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pAuthentication_tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt payload in AES CCM mode. </p>
<p>This API Encrypt payload in AES GCM mode using the specified key from STSAFE symmetric key table </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pSTSE</td><td>Pointer to STSE Handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slot_number</td><td>Key slot in symmetric key table to be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">authentication_tag_length</td><td>Expected length for the authentication tag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IV_length</td><td>IV buffer length in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IV</td><td>IV buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data_length</td><td>Length of the associated data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pAssociated_data</td><td>Buffer containing associated data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message_length</td><td>Length of the message to encrypt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pPlaintext_message</td><td>Buffer containing the message to encrypt </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pEncrypted_message</td><td>Buffer to store the encrypted message </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pAuthentication_tag</td><td>Buffer to store the authentication tag </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> : STSE_OK on success ; error code otherwise</dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d5d/a00311_source.html#l00126">126</a> of file <a class="el" href="../../d1/d5d/a00311_source.html">stse_aes.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d70/a00431_source.html#l00404">stsafea_aes_gcm_encrypt()</a>, and <a class="el" href="../../d3/d29/a00419_source.html#l00105">STSE_API_HANDLER_NOT_INITIALISED</a>.</p>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dd/de6/a00548_gafd9c3bad4b1c88f8b970802890dc4084_cgraph.png" border="0" usemap="#add/de6/a00548_gafd9c3bad4b1c88f8b970802890dc4084_cgraph" alt=""/></div>
<map name="add/de6/a00548_gafd9c3bad4b1c88f8b970802890dc4084_cgraph" id="add/de6/a00548_gafd9c3bad4b1c88f8b970802890dc4084_cgraph">
<area shape="rect" title="Encrypt payload in AES CCM mode." alt="" coords="5,5,176,32"/>
<area shape="rect" href="../../d2/dd7/a00567.html#ga7d5bab263e5b44411ac0f95ad826d40a" title="Encrypt payload in AES GCM mode." alt="" coords="224,5,415,32"/>
</map>
</div>

</div>
</div>
<a id="gac5f657a57f8b9cb48e1bfd145e52068b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac5f657a57f8b9cb48e1bfd145e52068b">&#9670;&nbsp;</a></span>stse_aes_gcm_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> stse_aes_gcm_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d2f/a00562.html#gaabe4b6e7682072e3e7798bbff6c0b77b">stse_Handler_t</a> *&#160;</td>
          <td class="paramname"><em>pSTSE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8&#160;</td>
          <td class="paramname"><em>slot_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8&#160;</td>
          <td class="paramname"><em>authentication_tag_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>IV_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pIV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>associated_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pAssociated_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI16&#160;</td>
          <td class="paramname"><em>message_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pEncrypted_message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pAuthentication_tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pVerification_result</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PLAT_UI8 *&#160;</td>
          <td class="paramname"><em>pPlaintext_message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt payload in AES GCM mode. </p>
<p>This API Decrypt payload in AES GCM mode using the specified key from STSAFE symmetric key table </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pSTSE</td><td>Pointer to STSE Handler </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slot_number</td><td>Key slot in symmetric key table to be used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">authentication_tag_length</td><td>Expected length for the authentication tag </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IV_length</td><td>IV buffer length in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IV</td><td>IV buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">associated_data_length</td><td>Length of the associated data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pAssociated_data</td><td>Buffer containing associated data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">message_length</td><td>Length of the message to encrypt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pEncrypted_message</td><td>Buffer containing the message to decrypt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pAuthentication_tag</td><td>Buffer containing the authentication tag </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pVerification_result</td><td>Verification result flag </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pPlaintext_message</td><td>Buffer to store the decrypted message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d0/d3e/a00566.html#ga6e312aa8b8cd38421ce8b85215e4b16f">stse_ReturnCode_t</a> : STSE_OK on success ; error code otherwise</dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d1/d5d/a00311_source.html#l00158">158</a> of file <a class="el" href="../../d1/d5d/a00311_source.html">stse_aes.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d70/a00431_source.html#l00508">stsafea_aes_gcm_decrypt()</a>, and <a class="el" href="../../d3/d29/a00419_source.html#l00105">STSE_API_HANDLER_NOT_INITIALISED</a>.</p>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../dd/de6/a00548_gac5f657a57f8b9cb48e1bfd145e52068b_cgraph.png" border="0" usemap="#add/de6/a00548_gac5f657a57f8b9cb48e1bfd145e52068b_cgraph" alt=""/></div>
<map name="add/de6/a00548_gac5f657a57f8b9cb48e1bfd145e52068b_cgraph" id="add/de6/a00548_gac5f657a57f8b9cb48e1bfd145e52068b_cgraph">
<area shape="rect" title="Decrypt payload in AES GCM mode." alt="" coords="5,5,176,32"/>
<area shape="rect" href="../../d2/dd7/a00567.html#gabb002a2e1be2750109ae2ed2a9e3a241" title="Decrypt payload in AES GCM mode." alt="" coords="224,5,415,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
